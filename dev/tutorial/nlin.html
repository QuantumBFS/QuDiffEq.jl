<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Non-linear Differential Equations · QuDiffEq.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><nav class="toc"><h1>QuDiffEq.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Tutorial</span><ul><li><a class="toctext" href="lin.html">Linear Differential Equations</a></li><li class="current"><a class="toctext" href="nlin.html">Non-linear Differential Equations</a><ul class="internal"><li><a class="toctext" href="#Usage-1">Usage</a></li></ul></li></ul></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/algs.html">Quantum Algorithms for differential equations</a></li><li><a class="toctext" href="../man/taylor.html">-</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorial</li><li><a href="nlin.html">Non-linear Differential Equations</a></li></ul><a class="edit-page" href="https://github.com/QuantumBFS/QuDiffEq.jl/blob/master/docs/src/tutorial/nlin.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Non-linear Differential Equations</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Non-linear-Differential-Equations-1" href="#Non-linear-Differential-Equations-1">Non-linear Differential Equations</a></h1><p><code>QuDiffEq</code> has two algorithms for solving non-linear differential equations:</p><ul><li><code>QuNLDE</code>: Uses function transformation and the forward Euler method.</li><li><code>QuLDE</code>: Linearises the differential equation at every iteration.</li></ul><h2><a class="nav-anchor" id="Usage-1" href="#Usage-1">Usage</a></h2><p>Let&#39;s say we want to solve the following set of differential equations.</p><div>\[\begin{array}{rcl} \frac{dz_1}{dt} &amp; = &amp; z_2 - 3 z_{1}^{2} \\ \frac{dz_2}{dt}  &amp;=&amp; -z_{2}^{2} - z_1 z_{2} \end{array}\]</div><p>Let&#39;s take the time interval to be from 0.0 to 0.4. We define the in initial vector randomly.</p><pre><code class="language-">using QuDiffEq
using OrdinaryDiffEq
using Random
using LinearAlgebra

tspan = (0.0,0.4)
x = normalize!(rand(2))</code></pre><ul><li>For <code>QuNLDE</code>, we need to define a <code>&lt;: QuODEProblem</code>. At present, we use only <code>QuLDEProblem</code> as a Qu problem wrapper. <code>QuNLDE</code> can solve only quadratic differential equations. <code>A</code> is the coefficient matrix for the quadratic differential equation.</li></ul><pre><code class="language-julia">N = 2 # size of the input vector
siz = nextpow(2, N + 1)

A = zeros(ComplexF32,2^(siz),2^(siz));
A[1,1] = ComplexF32(1);
A[5,3] = ComplexF32(1);
A[5,6] = ComplexF32(-3);
A[9,11] = ComplexF32(-1);
A[9,7] = ComplexF32(-1);</code></pre><pre><code class="language-none">-1.0f0 + 0.0f0im</code></pre><pre><code class="language-">qprob = QuLDEProblem(A,x,tspan)
</code></pre><p>To solve the problem we use <code>solve()</code></p><pre><code class="language-">res = solve(qprob,QuNLDE(), dt = 0.1)</code></pre><p>Comparing the result with <code>Euler()</code></p><pre><code class="language-">
function f(du,u,p,t)
    du[1] = -3*u[1]^2 + u[2]
    du[2] = -u[2]^2 - u[1]*u[2]
end

prob = ODEProblem(f, x, tspan)
sol = solve(prob, Euler(), dt = 0.1, adaptive = false)

using Plots;

plot(sol.t,real.(res),lw = 1,label=&quot;QuNLDE()&quot;)
plot!(sol,lw = 3, ls=:dash,label=&quot;Euler()&quot;)</code></pre><ul><li>For <code>QuLDE</code>, the problem is defined as a <code>ODEProblem</code>, similar to that in OrdinaryDiffEq.jl . <code>f</code> is the differential equation written symbolically. We can use prob from the previous case itself.</li></ul><pre><code class="language-">res = solve(prob,QuLDE(),dt = 0.1)

sol = solve(prob, Tsit5(), dt = 0.1, adaptive = false)

using Plots
plot(sol.t,real.(res),lw = 1,label=&quot;QuNLDE()&quot;)
plot!(sol,lw = 3, ls=:dash,label=&quot;Tsit5()&quot;)</code></pre><footer><hr/><a class="previous" href="lin.html"><span class="direction">Previous</span><span class="title">Linear Differential Equations</span></a><a class="next" href="../man/algs.html"><span class="direction">Next</span><span class="title">Quantum Algorithms for differential equations</span></a></footer></article></body></html>
